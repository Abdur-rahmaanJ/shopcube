{% extends "base/main_base.html" %}

{% set active_page = "people" %}

{% block pagehead %}
    <title>add people</title>
    <style>
        html {
        scroll-behavior: smooth;
        }
        .hidden {
            display: none;
        }

        .show {
            display: inline-block;
        }

        .active {
            width: 6rem;
            color: white;
            background-color: #34ce57;
        }

        .inactive {
            width: 6rem;
            color: white;
            background-color: #ff253a;
        }

        .all_inactive {
            display: none;
        }
    </style>
{% endblock %}

{% block content %}

<script type="text/javascript">
$(function() {
    $('#searchinput').on('input', function() {
       $("#results_table tbody").html("<tr></tr>");
       var result;
       var valEntered = $(searchinput).val();
       if (valEntered == '') valEntered='searchValueIsEmpty';
        $.getJSON( "/people/search/name/"+valEntered, function( data ) {
            for (var i = data.length - 1; i >= 0; i--) {
                result = data[i];
                
                $('#results_table tr:last').after("<tr>"+
                "<td>"+result['name']+"</td>"+
                "<td>"+result['date']+"</td>"+
                "<td>"+result['time']+"</td>"+
                "<td>"+result['active']+"</td>"+
                '<td class="delete_me" data-id="'+result['id']+'"><a href="/people/delete/'+result['id']+'" class="btn btn-danger" role="button"><i class="fas fa-trash-alt"></i></a>'+
                ' <a href="/people/edit/'+result['id']+'" class="btn btn-warning" role="button"><i class="fas fa-pencil-alt"></i></a></td>'+
                "</tr>");
            }
        })
    });
    $('.delete_me').click(function () {
        var id = $(this).data("id");
        var ask = confirm("Do you want to delete ?");
        if (ask == true) {
            window.location.replace("/people/delete/" + id, "_self");
            return false;
        } else {

        }
    });
    $('#isActive').change(function () {

        if ($('#isActive').is(':checked')) {
            $('.all_not').addClass('all_inactive');
        } else {
            $('.all_not').removeClass('all_inactive');
        }

    });
  });
</script>
  <div class="input-group mb-3">
    <div class="input-group-prepend">
      <span class="input-group-text"><i class="fas fa-search"></i></span>
    </div>
    <input autocomplete="off" type="text" id="searchinput" class=" form-control" placeholder="Search by name" name="Search">
  </div>
  
  <div id="search_results">
  </div>
  <br><br>
  <table class="table" id="results_table">
        <thead>
        <tr>
            <th scope="col">Meeting Name</th>
            <th scope="col">Date</th>
            <th scope="col">Time</th>
            <th scope="col">Active</th>
            <th></th>
        </tr>
        </thead>
        <tbody>
            {% for person in people %}
            <tr class="{% if person.active == "inactive" %}all_not{% endif %}">
                <td>{{ person.name }}</td>
                <td>{{ person.date }}</td>
                <td>{{ person.time }}</td>
                <td>
                    <div style='display: inline-block; '>
                        <a style="text-decoration: none;">
                            <button id='delete' class="delete_me btn btn-danger" type="" name="{{ person.id }}"><i
                                    class="fas fa-trash-alt"></i></button>
                        </a>
                        &nbsp;
                        <a href="/people/edit/{{ person.id }}" style="text-decoration: none;">
                            <button data-name="{{ person.name }}" class="btn btn-warning"><i id='ico' class="fas fa-pencil-alt"></i>
                            </button>
                        </a>
                    </div>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
{% endblock %}
